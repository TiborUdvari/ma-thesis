\usepackage{calc}

% Define Lengths
\newlength{\paperWidth}
\newlength{\paperHeight}
\newlength{\leftMargin}
\newlength{\rightMargin}
\newlength{\topMargin}
\newlength{\bottomMargin}
\newlength{\spiralWidth}

\newlength{\bleed}
\setlength{\bleed}{3mm} 

\newlength{\diagramPaperWidth}

\setlength{\spiralWidth}{10.7mm}
\setlength{\paperWidth}{158mm}
\setlength{\paperHeight}{210mm}

\setlength{\diagramPaperWidth}{\paperWidth}
\addtolength{\diagramPaperWidth}{\paperWidth}
\addtolength{\diagramPaperWidth}{-\spiralWidth}

% Define ratios
\newcommand{\marginRatio}{0.15}

% Use the ratio to calculate margins
% left margin needs bleed


\setlength{\leftMargin}{\paperWidth*\real{\marginRatio}} % 158 * 0.15
\setlength{\rightMargin}{\paperWidth*\real{\marginRatio}} % 
\setlength{\topMargin}{\paperHeight*\real{\marginRatio}}
\setlength{\bottomMargin}{\paperHeight*\real{\marginRatio}}

% \setlength{\leftMargin}{\paperWidth*\real{\marginRatio}+\bleed\relax} % 158 * 0.15
% \setlength{\rightMargin}{\paperWidth*\real{\marginRatio}+\bleed\relax} % 
% \setlength{\topMargin}{\paperHeight*\real{\marginRatio}+\bleed\relax}
% \setlength{\bottomMargin}{\paperHeight*\real{\marginRatio}+\bleed\relax}
